<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> 
 
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"> 
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
        <title>carcassonne</title>
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/mootools/1.2.4/mootools-yui-compressed.js"></script>
        <script type="text/javascript" src="/js/mootools-1.2.4.4-more.js"></script>
        <script type="text/javascript" src="/js/wsjson.js"></script>
        <script type="text/javascript" src="/js/res.js"></script>
        <script type="text/javascript" src="/js/carcassonne.js"></script>
        <script type="text/javascript">
            /*
            var board;
            var tile;
            var gamePanel;

            Element.Events.spacePressed = {
                base: 'keypress',
                condition: function(ev) {
                    return ev.key == 'space' && !ev.alt && !ev.control && !ev.shift;
                }
            };

            window.addEvent('domready', function() {
                board = new Board('B0');
                $(board).inject($("cont"));

                $("stop").addEvent('click', function() {
                    if (!tile)
                        return;
                    tile.meeple.stop();
                    tile.stop();
                    $(board).makeDraggable({handle: tile});
                });

                window.addEvent('click', function(ev) {
                    var coord = board.getGridCoord(ev.page);
                    coord['val'] = board.getNeighborCnt(coord);
                    $("neighbor").set("text", "{gX} {gY} {val}".substitute(coord));

                    if (board.occupied(coord))
                        return;

                    // handle the last tile
                    if (tile) {
                        tile.moveTo(coord);
                        return;
                    }
                });

                var createdCnt = 0;
                window.addEvent('dblclick', function(ev) {
                    var c = board.getGridCoord(ev.page);
                    if (board.occupied(c))
                        return;
                    
                    // add new one
                    var tileID = 'T' + createdCnt;
                    tile = board.createTile(tileID, Math.floor(Math.random()*24), c);
                    tile.makeDraggable();

                    var meeple = new Meeple('M' + createdCnt, 0, {
                        onShow: function(m, pos) {
                            $("meeple1").set("text", $("meeple1").get("text").toInt() - 1);
                            tile.freeze();
                        },
                        onHide: function(m) {
                            $("meeple1").set("text", $("meeple1").get("text").toInt() + 1);
                            tile.unfreeze();
                        },
                        onClick: function(m) {
                            m.hide();
                        }
                    });
                    $(meeple).inject(tile);
                    tile.meeple = meeple;

                    tile.addEvents({
                        'terraclick': function(t, terra, terraType, ev) {
                            if (!t.fit) {
                                meeple.hide();
                                return;
                            }

                            var pos = $(t).getPosition();
                            $(meeple).setProperty('title', terraType);
                            meeple.show({x: ev.page.x - pos.x, y: ev.page.y - pos.y});
                        }
                    });
                    
                    ++createdCnt;
                });

                window.addEvent("spacePressed", function() {
                    if (tile)
                        tile.rotate();
                    return false;
                });

            });
            */
        </script>
    <link rel="stylesheet" type="text/css" href="/styles/carcassonne.css" />
    <script type="text/javascript">
        /*
        var playerNum = null;
        window.addEvent("domready", function() {
            (new Player(1, 'jayven')).asSelf();
            gamePanel = new GamePanel();
            gamePanel.selectColor(Player.self, 1);
            gamePanel.makeReadyClickable();
            gamePanel.addEvent('ready', function() {
                $('msgHelp').set('text', '等待其它玩家');
            });
        });*/
        /*
        window.addEvent("domready", function() {
            carcassonne = Carcassonne();
        });*/

        window.addEvent("domready", function() {
            Carcassonne();
        });
    </script>
    </head>
    <body>
        <div id="loginPanel" class="alignC roundedBox hide">
            <div id="loginFormCont">
                <form id="loginForm" name="loginForm">
                    <table>
                        <tr>
                            <td class="alignR">请输入昵称: </td>
                            <td><input class="roundedBox" type="text" name="nickname" id="nickname" value="" /></td>
                            <td class="alignR">以及房间号: </td>
                            <td>
                                <select class="roundedBox" id="gameID" name="gameID">
                                    <option value="0">0</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                </select>
                            </td>
                            <td><input class="roundedBox" type="submit" value="提交" /></td>
                        </tr>
                        <tr>
                            <td colspan="5" id="loginErr"></td>
                        </tr>
                    </table>
                </form>
            </div>
            <div id="loginWait" class="hide">登录中, 请稍候...</div>
        </div>
        <div id="board" class="hide">
        </div>
        <div id="gamePanel" class="hide">
            <table class="scoreBoard roundedBox" id="scoreBoard0">
                <tr><td><div class="meeple meeple0" /></td><td id="playerName0"></td></tr>
                <tr><td class="alignR">meeple: </td><td id="meepleCnt0"></td></tr>
                <tr><td class="alignR">score: </td><td id="score0"></td></tr>
                <tr><td class="alignR"><div id="ready0">ready: </div></td><td id="readySt0"></td></tr>
            </table>
            <table class="scoreBoard roundedBox" id="scoreBoard1">
                <tr><td><div class="meeple meeple1" /></td><td id="playerName1"></td></tr>
                <tr><td class="alignR">meeple: </td><td id="meepleCnt1"></td></tr>
                <tr><td class="alignR">score: </td><td id="score1"></td></tr>
                <tr><td class="alignR"><div id="ready1">ready: </div></td><td id="readySt1"></td></tr>
            </table>
            <table class="scoreBoard roundedBox" id="scoreBoard2">
                <tr><td><div class="meeple meeple2" /></td><td id="playerName2"></td></tr>
                <tr><td class="alignR">meeple: </td><td id="meepleCnt2"></td></tr>
                <tr><td class="alignR">score: </td><td id="score2"></td></tr>
                <tr><td class="alignR"><div id="ready2">ready: </div></td><td id="readySt2"></td></tr>
            </table>
            <table class="scoreBoard roundedBox" id="scoreBoard3">
                <tr><td><div class="meeple meeple3" /></td><td id="playerName3"></td></tr>
                <tr><td class="alignR">meeple: </td><td id="meepleCnt3"></td></tr>
                <tr><td class="alignR">score: </td><td id="score3"></td></tr>
                <tr><td class="alignR"><div id="ready3">ready: </div></td><td id="readySt3"></td></tr>
            </table>
            <table class="scoreBoard roundedBox" id="scoreBoard4">
                <tr><td><div class="meeple meeple4" /></td><td id="playerName4"></td></tr>
                <tr><td class="alignR">meeple: </td><td id="meepleCnt4"></td></tr>
                <tr><td class="alignR">score: </td><td id="score4"></td></tr>
                <tr><td class="alignR"><div id="ready4">ready: </div></td><td id="readySt4"></td></tr>
            </table>
            <div class="roundedBox hide" id="gameInfo">剩下 <font id="remainTiles">0</font> 个小块</div>
            <div class="roundedBox toolBotton hide" id="mvCenter">居中</div>
            <div class="roundedBox toolBotton hide" id="turnEnd">回合结束</div>
        </div>
        <div id="msgPanel" class="hide alignC roundedBox">
            <div id="msgHelp" class="roundedBox">若已准备好, 请按记分板上的 ready </div>
            <div id="msgHistory" class="roundedBox"></div>
            <form id="msgForm" name="msgForm">
                <input class="roundedBox" size="30" type="text" id="msg" name="msg" />
                <input class="roundedBox floatR" type="submit" value="send" />
            </form>
        </div>
    </body>
</html>
